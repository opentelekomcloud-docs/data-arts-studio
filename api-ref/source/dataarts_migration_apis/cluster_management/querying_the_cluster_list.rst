:original_name: ListClusters_0.html

.. _ListClusters_0:

Querying the Cluster List
=========================

Function
--------

This API is used to query the cluster list.

URI
---

GET /v1.1/{project_id}/clusters

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID
   ========== ========= ====== ===========

Request Parameters
------------------

.. table:: **Table 2** Request header parameters

   +--------------+-----------+--------+----------------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                              |
   +==============+===========+========+==========================================================================================================+
   | X-Auth-Token | Yes       | String | User token. It can be obtained by calling the IAM API (value of X-Subject-Token in the response header). |
   +--------------+-----------+--------+----------------------------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 3** Response body parameters

   +-----------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+
   | Parameter | Type                                                                 | Description                                                                 |
   +===========+======================================================================+=============================================================================+
   | clusters  | Array of :ref:`clusters <listclusters_0__response_clusters>` objects | Cluster list. For details, see the descriptions of **clusters** parameters. |
   +-----------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+

.. _listclusters_0__response_clusters:

.. table:: **Table 4** clusters

   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                                           | Description                                                                                                                                                                                                           |
   +=======================+================================================================================================+=======================================================================================================================================================================================================================+
   | customerConfig        | :ref:`CustomerConfig <listclusters_0__response_customerconfig>` object                         | User configuration                                                                                                                                                                                                    |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | datastore             | :ref:`Datastore <listclusters_0__response_datastore>` object                                   | CDM information                                                                                                                                                                                                       |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | instances             | Array of :ref:`ClusterDetailInstance <listclusters_0__response_clusterdetailinstance>` objects | Cluster node information. For details, see the descriptions of **instances** parameters.                                                                                                                              |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | azName                | String                                                                                         | AZ name                                                                                                                                                                                                               |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | dbuser                | String                                                                                         | Database user                                                                                                                                                                                                         |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | flavorName            | String                                                                                         | Flavor name                                                                                                                                                                                                           |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | recentEvent           | Integer                                                                                        | Number of events                                                                                                                                                                                                      |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | isAutoOff             | Boolean                                                                                        | Auto shutdown                                                                                                                                                                                                         |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | isScheduleBootOff     | Boolean                                                                                        | Whether to enable scheduled startup/shutdown. The scheduled startup/shutdown and auto shutdown functions cannot be enabled at the same time.                                                                          |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | clusterMode           | String                                                                                         | Cluster mode: sharding                                                                                                                                                                                                |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | namespace             | String                                                                                         | Namespace                                                                                                                                                                                                             |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | task                  | :ref:`ClusterTask <listclusters_0__response_clustertask>` object                               | Task information                                                                                                                                                                                                      |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | publicEndpoint        | String                                                                                         | EIP bound to the cluster                                                                                                                                                                                              |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | actionProgress        | :ref:`ActionProgress <listclusters_0__response_actionprogress>` object                         | Cluster operation progress, which consists of a key and a value. The key indicates an ongoing task, and the value indicates the progress of the ongoing task. An example is "action_progress":{"SNAPSHOTTING":"16%"}. |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | created               | String                                                                                         | Cluster creation time in ISO 8601 format: YYYY-MM-DDThh:mm:ssZ                                                                                                                                                        |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bakExpectedStartTime  | String                                                                                         | Start time                                                                                                                                                                                                            |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bakKeepDay            | Integer                                                                                        | Retention duration                                                                                                                                                                                                    |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name                  | String                                                                                         | Cluster name                                                                                                                                                                                                          |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | statusDetail          | String                                                                                         | Cluster status: normal                                                                                                                                                                                                |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | id                    | String                                                                                         | Cluster ID                                                                                                                                                                                                            |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | isFrozen              | String                                                                                         | Whether the cluster is frozen. The value can be **0** (not frozen) or **1** (frozen).                                                                                                                                 |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | updated               | String                                                                                         | Cluster update time in ISO 8601 format: YYYY-MM-DDThh:mm:ssZ                                                                                                                                                          |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | status                | String                                                                                         | Cluster status                                                                                                                                                                                                        |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **100**: creating                                                                                                                                                                                                  |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **200**: normal                                                                                                                                                                                                    |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **300**: failed                                                                                                                                                                                                    |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **303**: failed to be created                                                                                                                                                                                      |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **500**: restarting                                                                                                                                                                                                |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **800**: frozen                                                                                                                                                                                                    |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **900**: stopped                                                                                                                                                                                                   |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **910**: stopping                                                                                                                                                                                                  |
   |                       |                                                                                                |                                                                                                                                                                                                                       |
   |                       |                                                                                                | -  **920**: starting                                                                                                                                                                                                  |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | failedReasons         | :ref:`FailedReasons <listclusters_0__response_failedreasons>` object                           | Failure cause. If this parameter is left empty, the cluster is in normal state.                                                                                                                                       |
   +-----------------------+------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _listclusters_0__response_customerconfig:

.. table:: **Table 5** CustomerConfig

   =============== ====== ================================
   Parameter       Type   Description
   =============== ====== ================================
   failureRemind   String Failure notification
   clusterName     String Cluster type
   serviceProvider String Service provisioning
   localDisk       String Whether the disk is a local disk
   ssl             String Whether to enable SSL
   createFrom      String Source
   resourceId      String Resource ID
   flavorType      String Flavor type
   workSpaceId     String Workspace ID
   trial           String Trial
   =============== ====== ================================

.. _listclusters_0__response_datastore:

.. table:: **Table 6** Datastore

   ========= ====== ======================================
   Parameter Type   Description
   ========= ====== ======================================
   type      String Type. Generally, the value is **cdm**.
   version   String Cluster version
   ========= ====== ======================================

.. _listclusters_0__response_clusterdetailinstance:

.. table:: **Table 7** ClusterDetailInstance

   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | Parameter             | Type                                                                         | Description                                                                             |
   +=======================+==============================================================================+=========================================================================================+
   | flavor                | :ref:`flavor <listclusters_0__response_flavor>` object                       | VM flavor of a node. For details, see the descriptions of **flavor** parameters.        |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | volume                | :ref:`volume <listclusters_0__response_volume>` object                       | Disk information of a node. For details, see the descriptions of **volume** parameters. |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | status                | String                                                                       | Node status                                                                             |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **100**: creating                                                                    |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **200**: normal                                                                      |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **300**: failed                                                                      |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **303**: failed to be created                                                        |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **400**: deleted                                                                     |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **800**: frozen                                                                      |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | actions               | Array of strings                                                             | Node operation status                                                                   |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **REBOOTING**: restarting                                                            |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **RESTORING**: restoring                                                             |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **REBOOT_FAILURE**: failed to restart                                                |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | type                  | String                                                                       | Node type. Currently, only **cdm** is available.                                        |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | id                    | String                                                                       | Node VM ID                                                                              |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | name                  | String                                                                       | Name of the VM on the node                                                              |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | isFrozen              | String                                                                       | Whether the node is frozen. The value can be **0** (not frozen) or **1** (frozen).      |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | components            | String                                                                       | Component                                                                               |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | config_status         | String                                                                       | Node configuration status. The value is null when the cluster list is queried.          |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **In-Sync**: The configuration has been synchronized.                                |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **Applying**: The configuration is in progress.                                      |
   |                       |                                                                              |                                                                                         |
   |                       |                                                                              | -  **Sync-Failure**: The configuration fails.                                           |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | role                  | String                                                                       | Instance role                                                                           |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | group                 | String                                                                       | Group                                                                                   |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | links                 | Array of :ref:`ClusterLinks <listclusters_0__response_clusterlinks>` objects | Link information                                                                        |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | paramsGroupId         | String                                                                       | Group ID                                                                                |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | publicIp              | String                                                                       | Public IP address                                                                       |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | manageIp              | String                                                                       | Management IP address                                                                   |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | trafficIp             | String                                                                       | Traffic IP address                                                                      |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | shard_id              | String                                                                       | Slice ID                                                                                |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | manage_fix_ip         | String                                                                       | Management fix IP address                                                               |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | private_ip            | String                                                                       | Private IP address                                                                      |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | internal_ip           | String                                                                       | Internal IP address                                                                     |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | resource              | Array of :ref:`Resource <listclusters_0__response_resource>` objects         | Resource information (null is returned for querying the cluster list)                   |
   +-----------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+

.. _listclusters_0__response_flavor:

.. table:: **Table 8** flavor

   +-----------+------------------------------------------------------------------------------+------------------+
   | Parameter | Type                                                                         | Description      |
   +===========+==============================================================================+==================+
   | id        | String                                                                       | VM flavor ID     |
   +-----------+------------------------------------------------------------------------------+------------------+
   | links     | Array of :ref:`ClusterLinks <listclusters_0__response_clusterlinks>` objects | Link information |
   +-----------+------------------------------------------------------------------------------+------------------+

.. _listclusters_0__response_volume:

.. table:: **Table 9** volume

   +-----------+--------+------------------------------------------------------------+
   | Parameter | Type   | Description                                                |
   +===========+========+============================================================+
   | type      | String | Type of disks on the node. Only local disks are supported. |
   +-----------+--------+------------------------------------------------------------+
   | size      | Long   | Size of the disk on the node (GB)                          |
   +-----------+--------+------------------------------------------------------------+

.. _listclusters_0__response_clusterlinks:

.. table:: **Table 10** ClusterLinks

   ========= ====== ============
   Parameter Type   Description
   ========= ====== ============
   rel       String Relationship
   href      String Link address
   ========= ====== ============

.. _listclusters_0__response_resource:

.. table:: **Table 11** Resource

   ============= ====== =====================
   Parameter     Type   Description
   ============= ====== =====================
   resource_id   String Resource ID
   resource_type String Resource type: server
   ============= ====== =====================

.. _listclusters_0__response_clustertask:

.. table:: **Table 12** ClusterTask

   =========== ====== ================
   Parameter   Type   Description
   =========== ====== ================
   description String Task description
   id          String Task ID
   name        String Task name
   =========== ====== ================

.. _listclusters_0__response_actionprogress:

.. table:: **Table 13** ActionProgress

   ============ ====== ===================================================
   Parameter    Type   Description
   ============ ====== ===================================================
   CREATING     String Cluster creation progress, for example, **29%**
   GROWING      String Cluster expansion progress, for example, **29%**
   RESTORING    String Cluster restoration progress, for example, **29%**
   SNAPSHOTTING String Cluster snapshotting progress, for example, **29%**
   REPAIRING    String Cluster repairing progress, for example, **29%**
   ============ ====== ===================================================

.. _listclusters_0__response_failedreasons:

.. table:: **Table 14** FailedReasons

   +---------------+----------------------------------------------------------------------+---------------------------------------+
   | Parameter     | Type                                                                 | Description                           |
   +===============+======================================================================+=======================================+
   | CREATE_FAILED | :ref:`CREATE_FAILED <listclusters_0__response_create_failed>` object | Cause of the cluster creation failure |
   +---------------+----------------------------------------------------------------------+---------------------------------------+

.. _listclusters_0__response_create_failed:

.. table:: **Table 15** CREATE_FAILED

   ========= ====== =============
   Parameter Type   Description
   ========= ====== =============
   errorCode String Error code
   errorMsg  String Failure cause
   ========= ====== =============

Example Requests
----------------

.. code-block:: text

   GET /v1.1/1551c7f6c808414d8e9f3c514a170f2e/clusters

Example Responses
-----------------

**Status code: 200**

ok

.. code-block::

   {
     "clusters" : [ {
       "publicEndpoint" : "49.xx.xx.10",
       "actionProgress" : { },
       "created" : "2018-09-05T08:38:25",
       "name" : "cdm-c018",
       "statusDetail" : "Normal",
       "id" : "bae65496-643e-47ca-84af-948672de7eeb",
       "isFrozen" : "0",
       "updated" : "2018-09-05T08:38:25",
       "status" : "200"
     } ]
   }

Status Codes
------------

+-------------+-------------------------------------------------------------------+
| Status Code | Description                                                       |
+=============+===================================================================+
| 200         | ok                                                                |
+-------------+-------------------------------------------------------------------+
| 400         | Request error.                                                    |
+-------------+-------------------------------------------------------------------+
| 401         | Authentication failed.                                            |
+-------------+-------------------------------------------------------------------+
| 403         | You do not have required permissions to perform this operation.   |
+-------------+-------------------------------------------------------------------+
| 404         | The requested resource was not found.                             |
+-------------+-------------------------------------------------------------------+
| 500         | An internal service error occurred. For details, see error codes. |
+-------------+-------------------------------------------------------------------+
| 503         | Service unavailable.                                              |
+-------------+-------------------------------------------------------------------+

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
