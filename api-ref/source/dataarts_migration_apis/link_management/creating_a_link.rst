:original_name: CreateLink_0.html

.. _CreateLink_0:

Creating a Link
===============

Function
--------

This API is used to create a link.

URI
---

POST /v1.1/{project_id}/clusters/{cluster_id}/cdm/link

.. table:: **Table 1** Path Parameters

   ========== ========= ====== ===========
   Parameter  Mandatory Type   Description
   ========== ========= ====== ===========
   project_id Yes       String Project ID
   cluster_id Yes       String Cluster ID
   ========== ========= ====== ===========

.. table:: **Table 2** Query Parameters

   +-----------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type   | Description                                                                                                                                  |
   +===========+===========+========+==============================================================================================================================================+
   | validate  | No        | String | When the parameter is set to **true**, the API only validates whether the parameters are correctly configured, but does not create any link. |
   +-----------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 3** Request header parameters

   +--------------+-----------+--------+----------------------------------------------------------------------------------------------------------+
   | Parameter    | Mandatory | Type   | Description                                                                                              |
   +==============+===========+========+==========================================================================================================+
   | X-Auth-Token | Yes       | String | User token. It can be obtained by calling the IAM API (value of X-Subject-Token in the response header). |
   +--------------+-----------+--------+----------------------------------------------------------------------------------------------------------+

.. table:: **Table 4** Request body parameters

   +-----------+-----------+-------------------------------------------------------------+-----------------------------------------------------------------------+
   | Parameter | Mandatory | Type                                                        | Description                                                           |
   +===========+===========+=============================================================+=======================================================================+
   | links     | Yes       | Array of :ref:`links <createlink_0__request_links>` objects | Link list. For details, see the descriptions of **links** parameters. |
   +-----------+-----------+-------------------------------------------------------------+-----------------------------------------------------------------------+

.. _createlink_0__request_links:

.. table:: **Table 5** links

   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | Parameter          | Mandatory       | Type                                                                        | Description                                                                              |
   +====================+=================+=============================================================================+==========================================================================================+
   | link-config-values | Yes             | :ref:`link-config-values <createlink_0__request_link-config-values>` object | Link parameters. For details, see the descriptions of **link-config-values** parameters. |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | creation-user      | No              | String                                                                      | User who created the link                                                                |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | name               | Yes             | String                                                                      | Link name                                                                                |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | id                 | No              | Integer                                                                     | Link ID                                                                                  |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | creation-date      | No              | Long                                                                        | Time when the link was created                                                           |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | connector-name     | Yes             | String                                                                      | Connector name. The mappings between the connectors and links are as follows:            |
   |                    |                 |                                                                             |                                                                                          |
   |                    |                 |                                                                             | **generic-jdbc-connector**: link to a relational database                                |
   |                    |                 |                                                                             | **obs-connector**: OBS link                                                              |
   |                    |                 |                                                                             | **hdfs-connector**: HDFS link                                                            |
   |                    |                 |                                                                             | **hbase-connector**: HBase or CloudTable link                                            |
   |                    |                 |                                                                             | **hive-connector**: Hive link                                                            |
   |                    |                 |                                                                             | **ftp-connector/sftp-connector**: link to an FTP or SFTP server                          |
   |                    |                 |                                                                             | **mongodb-connector**: MongoDB link                                                      |
   |                    |                 |                                                                             | **redis-connector**: Redis or DCS link                                                   |
   |                    |                 |                                                                             | **kafka-connector**: Kafka link                                                          |
   |                    |                 |                                                                             | **dis-connector**: DIS link                                                              |
   |                    |                 |                                                                             | **elasticsearch-connector**: Elasticsearch or CSS link                                   |
   |                    |                 |                                                                             | **dli-connector**: DLI link                                                              |
   |                    |                 |                                                                             | **http-connector**: HTTP or HTTPS link. This type of link does not have parameters.      |
   |                    |                 |                                                                             | **dms-kafka-connector**: DMS Kafka link                                                  |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | update-date        | No              | Long                                                                        | Time when the link was updated                                                           |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | enabled            | No              | Boolean                                                                     | Whether to activate the link. The default value is **true**.                             |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
   | update-user        | No              | String                                                                      | User who updated the link                                                                |
   +--------------------+-----------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------------------+

.. _createlink_0__request_link-config-values:

.. table:: **Table 6** link-config-values

   +------------------+-----------+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+
   | Parameter        | Mandatory | Type                                                                    | Description                                                                                     |
   +==================+===========+=========================================================================+=================================================================================================+
   | configs          | Yes       | Array of :ref:`configs <createlink_0__request_configs>` objects         | Data structure of link parameters. For details, see the descriptions of **configs** parameters. |
   +------------------+-----------+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+
   | extended-configs | No        | :ref:`extended-configs <createlink_0__request_extended-configs>` object | Extended configuration. For details, see the descriptions of **extended-configs** parameters.   |
   +------------------+-----------+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+
   | validators       | No        | Array of strings                                                        | Validator                                                                                       |
   +------------------+-----------+-------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------+

.. _createlink_0__request_configs:

.. table:: **Table 7** configs

   +-----------+-----------+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type                                                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   +===========+===========+=============================================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | inputs    | Yes       | Array of :ref:`Input <createlink_0__request_input>` objects | Input parameter list. Each element in the list is in **name,value** format. For details, see the descriptions of **inputs** parameters. In the **from-config-values** data structure, the value of this parameter varies with the source link type. For details, see section "Source Job Parameters" in the **Cloud Data Migration User Guide**. In the **to-cofig-values** data structure, the value of this parameter varies with the destination link type. For details, see section "Destination Job Parameters" in the **Cloud Data Migration User Guide**. For details about the **inputs** parameter in the **driver-config-values** data structure, see the job parameter descriptions. |
   +-----------+-----------+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | name      | Yes       | String                                                      | Configuration name. The value is **fromJobConfig** for a source job, **toJobConfig** for a destination job, and **linkConfig** for a link.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   +-----------+-----------+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | id        | No        | Integer                                                     | Configuration ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------+-----------+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | type      | No        | String                                                      | Configuration type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   +-----------+-----------+-------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createlink_0__request_input:

.. table:: **Table 8** Input

   ========= ========= ====== ===============
   Parameter Mandatory Type   Description
   ========= ========= ====== ===============
   name      Yes       String Parameter name
   value     Yes       String Parameter value
   type      No        String Value type
   ========= ========= ====== ===============

.. _createlink_0__request_extended-configs:

.. table:: **Table 9** extended-configs

   ========= ========= ====== ===========
   Parameter Mandatory Type   Description
   ========= ========= ====== ===========
   name      No        String Name
   value     No        String Value
   ========= ========= ====== ===========

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 10** Response body parameters

   +-------------------+------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter         | Type                                                                               | Description                                                                                                                                                                                                              |
   +===================+====================================================================================+==========================================================================================================================================================================================================================+
   | name              | String                                                                             | Link name                                                                                                                                                                                                                |
   +-------------------+------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | validation-result | Array of :ref:`validationResult <createlink_0__response_validationresult>` objects | Validation structure. If a link fails to be created, the failure cause is returned. For details, see the descriptions of **validation-result** parameters. If a link is successfully created, an empty list is returned. |
   +-------------------+------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createlink_0__response_validationresult:

.. table:: **Table 11** validationResult

   +------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Type                                                                                       | Description                                                                                                             |
   +============+============================================================================================+=========================================================================================================================+
   | linkConfig | Array of :ref:`validationLinkConfig <createlink_0__response_validationlinkconfig>` objects | Validation result of link creation or update. For details, see the descriptions of **validationLinkConfig** parameters. |
   +------------+--------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------+

.. _createlink_0__response_validationlinkconfig:

.. table:: **Table 12** validationLinkConfig

   +-----------------------+-----------------------+-----------------------+
   | Parameter             | Type                  | Description           |
   +=======================+=======================+=======================+
   | message               | String                | Error message         |
   +-----------------------+-----------------------+-----------------------+
   | status                | String                | ERROR,WARNING         |
   |                       |                       |                       |
   |                       |                       | Enumeration values:   |
   |                       |                       |                       |
   |                       |                       | -  **ERROR**          |
   |                       |                       |                       |
   |                       |                       | -  **WARNING**        |
   +-----------------------+-----------------------+-----------------------+

**Status code: 400**

.. table:: **Table 13** Response body parameters

   =============== ====== ======================
   Parameter       Type   Description
   =============== ====== ======================
   code            String Return code
   errCode         String Error code
   message         String Error message
   externalMessage String Additional information
   =============== ====== ======================

**Status code: 500**

.. table:: **Table 14** Response body parameters

   +-----------------------+-----------------------+-----------------------+
   | Parameter             | Type                  | Description           |
   +=======================+=======================+=======================+
   | message               | String                | Error message         |
   +-----------------------+-----------------------+-----------------------+
   | status                | String                | ERROR,WARNING         |
   |                       |                       |                       |
   |                       |                       | Enumeration values:   |
   |                       |                       |                       |
   |                       |                       | -  **ERROR**          |
   |                       |                       |                       |
   |                       |                       | -  **WARNING**        |
   +-----------------------+-----------------------+-----------------------+

Example Requests
----------------

.. code-block:: text

   POST /v1.1/1551c7f6c808414d8e9f3c514a170f2e/clusters/6ec9a0a4-76be-4262-8697-e7af1fac7920/cdm/link

   {
     "links" : [ {
       "link-config-values" : {
         "configs" : [ {
           "inputs" : [ {
             "name" : "linkConfig.databaseType",
             "value" : "MYSQL"
           }, {
             "name" : "linkConfig.host",
             "value" : "100.94.8.163"
           }, {
             "name" : "linkConfig.port",
             "value" : "3306"
           }, {
             "name" : "linkConfig.database",
             "value" : "DB_name"
           }, {
             "name" : "linkConfig.username",
             "value" : "username"
           }, {
             "name" : "linkConfig.password",
             "value" : "DB_password"
           }, {
             "name" : "linkConfig.fetchSize",
             "value" : "100000"
           }, {
             "name" : "linkConfig.usingNative",
             "value" : false
           } ],
           "name" : "linkConfig"
         } ]
       },
       "name" : "mysql_link",
       "creation-date" : 1496654788622,
       "connector-name" : "generic-jdbc-connector",
       "update-date" : 1496654788622,
       "enabled" : true
     } ]
   }

Example Responses
-----------------

**Status code: 200**

OK

.. code-block::

   {
     "name" : "rdb_link",
     "validation-result" : [ { } ]
   }

**Status code: 400**

Request error.

.. code-block::

   {
     "code" : "Cdm.0315",
     "errCode" : "Cdm.0315",
     "message" : "Link name [ftp_link] already exist or created by other user.",
     "externalMessage" : "Link name [ftp_link] already exist or created by other user."
   }

**Status code: 500**

An internal service error occurred. For details, see error codes.

.. code-block::

   {
     "validation-result" : [ {
       "linkConfig" : [ {
         "message" : "Can't connect to the database with given credentials: The authentication type 12 is not supported. Check that you have configured the pg_hba.conf file to include the client's IP address or subnet, and that it is using an authentication scheme supported by the driver.",
         "status" : "ERROR"
       } ]
     } ]
   }

Status Codes
------------

+-------------+-------------------------------------------------------------------+
| Status Code | Description                                                       |
+=============+===================================================================+
| 200         | OK                                                                |
+-------------+-------------------------------------------------------------------+
| 400         | Request error.                                                    |
+-------------+-------------------------------------------------------------------+
| 401         | Authentication failed.                                            |
+-------------+-------------------------------------------------------------------+
| 403         | You do not have required permissions to perform this operation.   |
+-------------+-------------------------------------------------------------------+
| 404         | The requested resource was not found.                             |
+-------------+-------------------------------------------------------------------+
| 500         | An internal service error occurred. For details, see error codes. |
+-------------+-------------------------------------------------------------------+
| 503         | Service unavailable.                                              |
+-------------+-------------------------------------------------------------------+

Error Codes
-----------

See :ref:`Error Codes <errorcode>`.
