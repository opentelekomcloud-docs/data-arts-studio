:original_name: dataartsstudio_01_1824.html

.. _dataartsstudio_01_1824:

Developing a Real-Time Processing Single-Task MRS Flink Jar Job
===============================================================

Prerequisites
-------------

A single-task real-time processing Flink Jar job has been created. For details, see :ref:`Creating a Job <dataartsstudio_01_0434>`.

Configuring the MRS Flink Jar Job
---------------------------------

.. table:: **Table 1** MRS Flink Jar job parameters

   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                  | Mandatory             | Description                                                                                                                                                                                                                                                                                                                    |
   +============================+=======================+================================================================================================================================================================================================================================================================================================================================+
   | Flink Job Name             | Yes                   | Enter the Flink job name.                                                                                                                                                                                                                                                                                                      |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | The name is automatically generated in *Workspace-Job name* format.                                                                                                                                                                                                                                                            |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | The job name can contain 1 to 64 characters. Only letters, digits, hyphens (-), and underscores (_) are allowed. Chinese characters are not allowed.                                                                                                                                                                           |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | MRS Cluster                | Yes                   | Select an MRS cluster.                                                                                                                                                                                                                                                                                                         |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | .. note::                                                                                                                                                                                                                                                                                                                      |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |    Currently, jobs with a single Flink Jar node support MRS 3.2.0-LTS.1 and later versions.                                                                                                                                                                                                                                    |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Program Parameter          | No                    | Set job running parameters. This parameter is displayed only after an MRS cluster is selected.                                                                                                                                                                                                                                 |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | (Optional) Configure optimization parameters such as threads, memory, and vCPUs for the job to optimize resource usage and improve job execution performance.                                                                                                                                                                  |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | .. caution::                                                                                                                                                                                                                                                                                                                   |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |    CAUTION:                                                                                                                                                                                                                                                                                                                    |
   |                            |                       |    You can query historical checkpoints and select a specified checkpoint to start a Flink JAR job. To make a Flink checkpoint take effect, configure the following two parameters:                                                                                                                                            |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |    -  Checkpoint interval:                                                                                                                                                                                                                                                                                                     |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |       **-yD: execution.checkpointing.interval=1000**                                                                                                                                                                                                                                                                           |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |    -  Number of reserved checkpoints:                                                                                                                                                                                                                                                                                          |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |       **-yD: state.checkpoints.num-retained=10**                                                                                                                                                                                                                                                                               |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |       When querying the checkpoint list, enter parameter **-s** and click the parameter value text box. The parameter value will be automatically displayed.                                                                                                                                                                   |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | .. note::                                                                                                                                                                                                                                                                                                                      |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       |    This parameter is mandatory if the cluster version is MRS 1.8.7 or later than MRS 2.0.1.                                                                                                                                                                                                                                    |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | Click **Select Template** and select a parameter template. You can also select multiple templates. For details on how to create data connections, see :ref:`Configuring a Template <dataartsstudio_01_1282>`.                                                                                                                  |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | For details about the parameters of MRS Flink jobs, see **Managing an Existing Cluster** > **Job Management** > **Running a Flink Job** in *MapReduce Service (MRS) User Guide*.                                                                                                                                               |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Job Execution Parameter    | No                    | Set the parameters for the Flink job.                                                                                                                                                                                                                                                                                          |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | Variables required for executing the Flink job. These variables are specified by the functions in the Hive script. Multiple parameters are separated by spaces.                                                                                                                                                                |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | MRS Resource Queue         | No                    | Select a created MRS resource queue.                                                                                                                                                                                                                                                                                           |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | This parameter is mandatory if :ref:`Whether MRS Resource Queue Is Mandatory <dataartsstudio_01_04501__section146531751579>` is set to **Yes**.                                                                                                                                                                                |
   |                            |                       |                                                                                                                                                                                                                                                                                                                                |
   |                            |                       | Select a queue you configured in the queue permissions of DataArts Security. If you set multiple resource queues for this node, the resource queue you select here has the highest priority.                                                                                                                                   |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Flink job resource package | Yes                   | Select a JAR package. Before selecting a JAR package, upload the JAR package to the OBS bucket, create a resource on the **Manage Resource** page, and add the JAR package to the resource management list. For details, see :ref:`Creating a Resource <dataartsstudio_01_0519__en-us_topic_0165312432_section6325757145320>`. |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Rerun Policy               | No                    | -  Rerun from the previous checkpoint                                                                                                                                                                                                                                                                                          |
   |                            |                       | -  Rerun the job                                                                                                                                                                                                                                                                                                               |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Input Data Path            | No                    | Set the input data path. You can select an HDFS or OBS path.                                                                                                                                                                                                                                                                   |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Output Data Path           | No                    | Set the output data path. You can select an HDFS or OBS path.                                                                                                                                                                                                                                                                  |
   +----------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 2** Advanced settings

   +---------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                       | Mandatory             | Description                                                                                                                                               |
   +=================================+=======================+===========================================================================================================================================================+
   | Job Status Polling Interval (s) | Yes                   | Set the interval at which the system checks whether the job is complete. The interval can range from 30s to 60s, or 120s, 180s, 240s, or 300s.            |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       | During job execution, the system checks the job status at the configured interval.                                                                        |
   +---------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Maximum Wait Time               | Yes                   | Set the timeout interval for the job. If the job is not complete within the timeout interval and retry is enabled, the job will be executed again.        |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       | .. note::                                                                                                                                                 |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       |    If the job is in starting state and fails to start, it will fail upon timeout.                                                                         |
   +---------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Retry upon Failure              | No                    | Whether to re-execute a node if it fails to be executed.                                                                                                  |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       | -  **Yes**: The node task will be re-executed, and the following parameters must be configured:                                                           |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       |    -  Retry upon Timeout                                                                                                                                  |
   |                                 |                       |    -  **Maximum Retries**                                                                                                                                 |
   |                                 |                       |    -  **Retry Interval (seconds)**                                                                                                                        |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       | -  **No**: The node will not be re-executed. This is the default setting.                                                                                 |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       | .. note::                                                                                                                                                 |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       |    If retry is configured for a job node and the timeout duration is configured, the system allows you to retry a node when the node execution times out. |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       |    If a node is not re-executed when it fails upon timeout, you can go to the **Default Configuration** page to modify this policy.                       |
   |                                 |                       |                                                                                                                                                           |
   |                                 |                       |    **Retry upon Timeout** is displayed only when **Retry upon Failure** is set to **Yes**.                                                                |
   +---------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------+

After setting the parameters, click **Save** and submit the job.

Click **Start** to run the job.

Configuring Basic Job Information
---------------------------------

.. table:: **Table 3** Basic job information

   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                                           | Description                                                                                                                                                                                                                                                                                                   |
   +=====================================================+===============================================================================================================================================================================================================================================================================================================+
   | Owner                                               | An owner configured during job creation is automatically matched. This parameter value can be modified.                                                                                                                                                                                                       |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Executor                                            | This parameter is available when **Scheduling Identities** is set to **Yes**.                                                                                                                                                                                                                                 |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | User that executes the job. When you enter an executor, the job is executed by the executor. If the executor is left unspecified, the job is executed by the user who submitted the job for startup.                                                                                                          |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | .. note::                                                                                                                                                                                                                                                                                                     |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     |    You can configure execution users only after you apply for the whitelist membership. To enable it, contact customer service or technical support.                                                                                                                                                          |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Job Agency                                          | This parameter is available when **Scheduling Identities** is set to **Yes**.                                                                                                                                                                                                                                 |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | After an agency is configured, the job interacts with other services as an agency during job execution.                                                                                                                                                                                                       |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Priority                                            | Priority configured during job creation is automatically matched. This parameter value can be modified.                                                                                                                                                                                                       |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Execution Timeout                                   | Timeout of the job instance. If this parameter is set to 0 or is not set, this parameter does not take effect. If the notification function is enabled for the job and the execution time of the job instance exceeds the preset value, the system sends a specified notification, and the job keeps running. |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Exclude Waiting Time from Instance Timeout Duration | Whether to exclude the wait time from the instance execution timeout duration                                                                                                                                                                                                                                 |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | If you select this option, the time to wait before an instance starts running is excluded from the timeout duration. You can modify this setting in :ref:`Default Configuration > Exclude Waiting Time from Instance Timeout Duration <dataartsstudio_01_04501__section14959925164217>`.                      |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | If you do not select this option, the time to wait before an instance starts running is included in the timeout duration.                                                                                                                                                                                     |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Custom Parameter                                    | Set the name and value of the parameter.                                                                                                                                                                                                                                                                      |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Job Tag                                             | Configure job tags to manage jobs by category.                                                                                                                                                                                                                                                                |
   |                                                     |                                                                                                                                                                                                                                                                                                               |
   |                                                     | Click **Add** to add a tag to the job. You can also select a tag configured in :ref:`Managing Job Tags <dataartsstudio_01_0532>`.                                                                                                                                                                             |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Job Description                                     | Description of the job                                                                                                                                                                                                                                                                                        |
   +-----------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Configuring Job Parameters
--------------------------

Click **Parameters** on the right of the editor and set the parameters described in :ref:`Table 4 <dataartsstudio_01_1824__en-us_topic_0000001647814241_en-us_topic_0099797007_table20701161192718>`.

.. _dataartsstudio_01_1824__en-us_topic_0000001647814241_en-us_topic_0099797007_table20701161192718:

.. table:: **Table 4** Job parameters

   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Function                                                                     | Description                                                                                                                                                                                     |
   +==============================================================================+=================================================================================================================================================================================================+
   | **Variables**                                                                |                                                                                                                                                                                                 |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Add                                                                          | Click **Add** and enter the variable parameter name and parameter value in the text boxes.                                                                                                      |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | -  Parameter name                                                                                                                                                                               |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              |    Only letters, numbers, periods (.), hyphens (-), and underscores (_) are allowed.                                                                                                            |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | -  Parameter value                                                                                                                                                                              |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              |    -  The string type of parameter value is a character string, for example, **str1**.                                                                                                          |
   |                                                                              |    -  The numeric type of parameter value is a number or operation expression.                                                                                                                  |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | After the parameter is configured, it is referenced in the format of **$**\ {*parameter name*} in the job.                                                                                      |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Edit Parameter Expression                                                    | Click |image1| next to the parameter value text box. In the displayed dialog box, edit the parameter expression. For more expressions, see :ref:`Expression Overview <dataartsstudio_01_0494>`. |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Modify                                                                       | Change the parameter name or value in the corresponding text boxes.                                                                                                                             |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Mask                                                                         | If the parameter value is a key, click |image2| to mask the value for security purposes.                                                                                                        |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete                                                                       | Click |image3| next to the parameter name and value text boxes to delete the job parameter.                                                                                                     |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | **Constant Parameter**                                                       |                                                                                                                                                                                                 |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Add                                                                          | Click **Add** and enter the constant parameter name and parameter value in the text boxes.                                                                                                      |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | -  Parameter name                                                                                                                                                                               |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              |    Only letters, numbers, periods (.), hyphens (-), and underscores (_) are allowed.                                                                                                            |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | -  Parameter value                                                                                                                                                                              |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              |    -  The string type of parameter value is a character string, for example, **str1**.                                                                                                          |
   |                                                                              |    -  The numeric type of parameter value is a number or operation expression.                                                                                                                  |
   |                                                                              |                                                                                                                                                                                                 |
   |                                                                              | After the parameter is configured, it is referenced in the format of **$**\ {*parameter name*} in the job.                                                                                      |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Edit Parameter Expression                                                    | Click |image4| next to the parameter value text box. In the displayed dialog box, edit the parameter expression. For more expressions, see :ref:`Expression Overview <dataartsstudio_01_0494>`. |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Modify                                                                       | Modify the parameter name and parameter value in text boxes and save the modifications.                                                                                                         |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete                                                                       | Click |image5| next to the parameter name and value text boxes to delete the job parameter.                                                                                                     |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | **Workspace Environment Variables**                                          |                                                                                                                                                                                                 |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | View the variables and constants that have been configured in the workspace. |                                                                                                                                                                                                 |
   +------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Click the **Parameter Preview** tab and configure the parameters listed in :ref:`Table 5 <dataartsstudio_01_1824__en-us_topic_0000001647814241_table1036167182419>`.

.. _dataartsstudio_01_1824__en-us_topic_0000001647814241_table1036167182419:

.. table:: **Table 5** Job parameter preview

   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Function                          | Description                                                                                                                                                      |
   +===================================+==================================================================================================================================================================+
   | Current Time                      | This parameter is displayed only when **Scheduling Type** is set to **Run once**. The default value is the current time.                                         |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Event Triggering Time             | This parameter is displayed only when **Scheduling Type** is set to **Event-based**. The default value is the time when an event is triggered.                   |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Scheduling Period                 | This parameter is displayed only when **Scheduling Type** is set to **Run periodically**. The default value is the scheduling period.                            |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Start Time                        | This parameter is displayed only when **Scheduling Type** is set to **Run periodically**. The value is the configured job execution time.                        |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Start Time                        | This parameter is displayed only when **Scheduling Type** is set to **Run periodically**. The value is the time when the periodic job scheduling starts.         |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Subsequent Instances              | Number of job instances scheduled.                                                                                                                               |
   |                                   |                                                                                                                                                                  |
   |                                   | -  The default value is **1** when **Scheduling Type** is set to **Run once**.                                                                                   |
   |                                   |                                                                                                                                                                  |
   |                                   | -  The default value is **1** when **Scheduling Type** is set to **Event-based**.                                                                                |
   |                                   |                                                                                                                                                                  |
   |                                   | -  When **Scheduling Type** is set to **Run periodically**:                                                                                                      |
   |                                   |                                                                                                                                                                  |
   |                                   |    If the number of instances exceeds 10, a maximum of 10 instances can be displayed, and the system displays message "A maximum of 10 instances are supported." |
   +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. note::

   In **Parameter Preview**, if a job parameter has a syntax error, the system displays a message.

   If a parameter depends on the data generated during job execution, such data cannot be simulated and displayed in **Parameter Preview**.

.. |image1| image:: /_static/images/en-us_image_0000002234237164.png
.. |image2| image:: /_static/images/en-us_image_0000002234077316.png
.. |image3| image:: /_static/images/en-us_image_0000002269116521.png
.. |image4| image:: /_static/images/en-us_image_0000002269116529.png
.. |image5| image:: /_static/images/en-us_image_0000002269196601.png
