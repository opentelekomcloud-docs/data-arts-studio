:original_name: dataartsstudio_01_0498.html

.. _dataartsstudio_01_0498:

Job Embedded Objects
====================

A job object provides properties and methods of obtaining the output message, job scheduling plan time, and job execution time of the previous node in a job.

Properties and Methods
----------------------

.. table:: **Table 1** **Property description**

   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+
   | Property  | Type           | Description                                                                                                                             |
   +===========+================+=========================================================================================================================================+
   | name      | String         | Job name.                                                                                                                               |
   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+
   | planTime  | java.util.Date | Job scheduling plane time, that is, the time configured for periodic scheduling, for example, to schedule a job at 1:01 a.m. every day. |
   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+
   | startTime | java.util.Date | Job execution time. It may be the same as or later than the planTime (because the job engine is busy).                                  |
   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+
   | eventData | String         | Message obtained from the stream when the event-driven scheduling is used.                                                              |
   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+
   | projectId | String         | ID of the project where the DataArts Factory module is located.                                                                         |
   +-----------+----------------+-----------------------------------------------------------------------------------------------------------------------------------------+

.. table:: **Table 2** Method description

   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Method                                                    | Description                                                                                                                                                                                                                                                                                               | Example                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +===========================================================+===========================================================================================================================================================================================================================================================================================================+====================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | String getNodeStatus(String nodeName)                     | Obtains the running status of a specified node. If the node runs properly, success is returned. If the node fails to run, fail is returned.                                                                                                                                                               | Obtain the running status of the test node:                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | For example, to check whether a node is running successfully, you can use the following command, where **test** indicates the node name:                                                                                                                                                                  | #{Job.getNodeStatus("test")}                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | **#{(Job.getNodeStatus("test")) == "success" }**                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getNodeOutput(String nodeName)                     | Obtains the output of a specified node. This method can only obtain the output of the previous dependent node.                                                                                                                                                                                            | -  Obtain the output of the test node:                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           |    #{Job.getNodeOutput("test")}                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | -  If the previous node has no execution result, the output is null.                                                                                                                                                                                                                                                                                                                                                               |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | -  If the output of a node is a field, the output result is in the format like **[["000"]]**. In this case, you can use the EL expression to split the string result and obtain the field value output by the previous node. Note that the output result type is string. If you want to output the original data type, you need to use the EL expression of the For Each node and the loop embedded objects supported by the node. |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           |    #{StringUtil.split(StringUtil.split(StringUtil.split(Job.getNodeOutput("Name of the previous node"),"]")[0],"[")[0],"\\\\"")[0]}                                                                                                                                                                                                                                                                                                |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | -  If the output of a node contains two or more fields, the output result is in the format like **[["000"],["001"]]**. In this case, you need to obtain the output result using the EL expression of the For Each node and the loop embedded objects supported by the node, for example, **#{Loop.current[0]}**.                                                                                                                   |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getParam(String key)                               | Obtains job parameters.                                                                                                                                                                                                                                                                                   | Obtain the value of the **test** parameter:                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | This method only obtains the parameter values configured for the current job, but not parameter values passed from the parent job or the global variables configured for the workspace.                                                                                                                   | #{Job.getParam("test")}                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | To obtain the parameter values passed from the parent job and the global variables configured for the workspace, you are advised to use the ${job_param_name} expression.                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getPlanTime(String pattern)                        | Obtains the plan time character string in a specified pattern. Pattern indicates the date and time mode. For details, see :ref:`Date and Time Mode <dataartsstudio_01_0496>`.                                                                                                                             | Obtain the planned job scheduling time, which is accurate to millisecond:                                                                                                                                                                                                                                                                                                                                                          |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | #{Job.getPlanTime("yyyy-MM-dd HH:mm:ss:SSS")}                                                                                                                                                                                                                                                                                                                                                                                      |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getYesterday(String pattern)                       | Obtains the time character string of the day before the plan time. Pattern indicates the date and time mode. For details, see :ref:`Date and Time Mode <dataartsstudio_01_0496>`.                                                                                                                         | Obtain the time on the previous day of the planned job scheduling time, which is accurate to date:                                                                                                                                                                                                                                                                                                                                 |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | #{Job.getYesterday("yyyy-MM-dd HH:mm:ss:SSS")}                                                                                                                                                                                                                                                                                                                                                                                     |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getLastHour(String pattern)                        | Obtains the time character string of last hour before the plan time. Pattern indicates the date and time mode. For details, see :ref:`Date and Time Mode <dataartsstudio_01_0496>`.                                                                                                                       | Obtain the time one hour before the planned job scheduling time, which is accurate to hour:                                                                                                                                                                                                                                                                                                                                        |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | #{Job.getLastHour("yyyy-MM-dd HH:mm:ss:SSS")}                                                                                                                                                                                                                                                                                                                                                                                      |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getRunningData(String nodeName)                    | Obtains the data recorded during the running of a specified node. Currently, only the IDs of the jobs running using SQL statements on the DLI SQL node can be obtained. This method can only obtain the output of the previous dependent node.                                                            | Obtain the ID of the job run by the third statement in the test of the DLI SQL node:                                                                                                                                                                                                                                                                                                                                               |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | For example, to obtain the job ID of the third statement on DLI node **DLI_INSERT_DATA**, run the following command: **#{JSONUtil.path(Job.getRunningData("DLI_INSERT_DATA"),"jobIds[2]")}**.                                                                                                             | #{JSONUtil.path(Job.getRunningData("test"),"jobIds[2]")}                                                                                                                                                                                                                                                                                                                                                                           |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getInsertJobId(String nodeName)                    | Returns the job ID in the first Insert SQL statement of the specified DLI SQL or Transform Load node. If the **nodeName** parameter is not specified, the job ID in the first DLI Insert SQL statement of the DLI SQL node is obtained. If the job ID cannot be obtained, the **null** value is returned. | Obtain the ID of job run by the first Insert SQL statement in the test of the DLI SQL node:                                                                                                                                                                                                                                                                                                                                        |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           |                                                                                                                                                                                                                                                                                                           | #{Job.getInsertJobId("test")}                                                                                                                                                                                                                                                                                                                                                                                                      |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getPreviousWorkday(Integer num, String pattern)    | Returns the time string of the **num** working day before a planned time specified by **pattern**. The value of **num** must be a positive integer. If no result that meets the specified condition is found, null is returned.                                                                           | Obtains the date of the fifth working day before a specified day.                                                                                                                                                                                                                                                                                                                                                                  |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | This EL expression is suitable for selecting custom dates in a calendar to schedule jobs.                                                                                                                                                                                                                 | #{Job.getPreviousWorkday(5, "yyyyMMdd")}                                                                                                                                                                                                                                                                                                                                                                                           |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | String getPreviousNonWorkday(Integer num, String pattern) | Returns the time string of the **num** non-working day before a planned time specified by **pattern**. The value of **num** must be a positive integer. If no result that meets the specified condition is found, null is returned.                                                                       | Obtains the date of the first non-working day before a specified day.                                                                                                                                                                                                                                                                                                                                                              |
   |                                                           |                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                                           | This EL expression is suitable for selecting custom dates in a calendar to schedule jobs.                                                                                                                                                                                                                 | #{Job.getPreviousNonWorkday(1, "yyyyMMdd")}                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Example 1
---------

The expression used to obtain the output of node **test** in the job is as follows:

.. code-block::

   #{Job.getNodeOutput("test")}
