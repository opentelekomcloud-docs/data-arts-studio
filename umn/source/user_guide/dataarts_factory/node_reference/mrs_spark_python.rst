:original_name: dataartsstudio_01_0456.html

.. _dataartsstudio_01_0456:

MRS Spark Python
================

Functions
---------

The MRS Spark Python node is used to execute a predefined Spark Python job on MRS.

For details about how to use the MRS Spark Python operator, see :ref:`Developing an MRS Spark Python Job <dataartsstudio_01_0525>`.

Parameters
----------

:ref:`Table 1 <dataartsstudio_01_0456__en-us_topic_0177038589_table3764823994826>`, :ref:`Table 2 <dataartsstudio_01_0456__en-us_topic_0177038589_table7463135744918>`, and :ref:`Table 3 <dataartsstudio_01_0456__en-us_topic_0114569494_table987664914213>` describe the parameters of the MRS Spark Pythonnode node.

.. _dataartsstudio_01_0456__en-us_topic_0177038589_table3764823994826:

.. table:: **Table 1** Parameters of MRS Spark Python nodes

   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                   | Mandatory             | Description                                                                                                                                                                                     |
   +=============================+=======================+=================================================================================================================================================================================================+
   | Node Name                   | Yes                   | Name of a node. The name must contain 1 to 128 characters, including only letters, numbers, underscores (_), hyphens (-), slashes (/), less-than signs (<), and greater-than signs (>).         |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Job Name                    | Yes                   | MRS job name. It can contain a maximum of 64 characters. Only letters, digits, hyphens (-), and underscores (_) are allowed.                                                                    |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | The system can automatically enter a job name in *Job name_Node name* format.                                                                                                                   |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | .. note::                                                                                                                                                                                       |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       |    The job name cannot contain Chinese characters or more than 64 characters. If the job name does not meet requirements, the MRS job will fail to be submitted.                                |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Script Type                 | Yes                   | -  Offline                                                                                                                                                                                      |
   |                             |                       | -  Online                                                                                                                                                                                       |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | MRS Cluster Name            | Yes                   | Select an MRS cluster that supports Spark Python. Only a specific version of MRS supports Spark Python. Test the cluster first to ensure that it supports Spark Python.                         |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | To create an MRS cluster, use either of the following methods:                                                                                                                                  |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | -  Click |image1|. On the **Clusters** page, create an MRS cluster.                                                                                                                             |
   |                             |                       | -  Go to the MRS console to create an MRS cluster.                                                                                                                                              |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | For details about how to create a cluster, see section "Buying a Custom Cluster" in *MapReduce Service (MRS) Usage Guide*.                                                                      |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | MRS Resource Queue          | No                    | Select a created MRS resource queue.                                                                                                                                                            |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | This parameter is mandatory if :ref:`Whether MRS Resource Queue Is Mandatory <dataartsstudio_01_04501__section146531751579>` is set to **Yes**.                                                 |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | .. note::                                                                                                                                                                                       |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       |    Select a queue you configured in the queue permissions of DataArts Security. If you set multiple resource queues for this node, the resource queue you select here has the highest priority. |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | SQL Script                  | Yes                   | This parameter is available only when **Script Type** is set to **Online**.                                                                                                                     |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | Select a Spark Python script.                                                                                                                                                                   |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Script Parameter            | No                    | This parameter is available only when **Script Type** is set to **Online**.                                                                                                                     |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | If the associated Spark Python script uses a parameter, the parameter name is displayed. Set the parameter value in the text box next to the parameter name.                                    |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Program Parameter           | No                    | This parameter is available only when **Script Type** is set to **Online**.                                                                                                                     |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | Configure optimization parameters such as threads, memory, and vCPUs for the job to optimize resource usage and improve job execution performance.                                              |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | .. note::                                                                                                                                                                                       |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       |    This parameter is mandatory if the cluster version is MRS 1.8.7 or later than MRS 2.0.1.                                                                                                     |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | For details about the parameters of MRS Spark jobs, see **Managing an Existing Cluster** > **Job Management** > **Running a Spark Job** in *MapReduce Service (MRS) User Guide*.                |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                   | Yes                   | This parameter is available only when **Script Type** is set to **Offline**.                                                                                                                    |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | Enter parameters. Press **Enter** between parameters.                                                                                                                                           |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Execution Program Parameter | No                    | Enter parameters of the MRS execution program.                                                                                                                                                  |
   |                             |                       |                                                                                                                                                                                                 |
   |                             |                       | Use spaces to separate parameters. To prevent parameters from being saved as plaintext, add an at sign (@) before parameters.                                                                   |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Attribute                   | No                    | Enter parameters in the key=value format. Use **Enter** to separate multiple parameters.                                                                                                        |
   +-----------------------------+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _dataartsstudio_01_0456__en-us_topic_0177038589_table7463135744918:

.. table:: **Table 2** Advanced parameters

   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter                                                      | Mandatory             | Description                                                                                                                                                                                                                                                  |
   +================================================================+=======================+==============================================================================================================================================================================================================================================================+
   | Max. Node Execution Duration                                   | Yes                   | Execution timeout interval for the node. If retry is configured and the execution is not complete within the timeout interval, the node will be executed again.                                                                                              |
   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Retry upon Failure                                             | Yes                   | Whether to re-execute a node if it fails to be executed. Possible values:                                                                                                                                                                                    |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       | -  **Yes**: The node will be re-executed, and the following parameters must be configured:                                                                                                                                                                   |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       |    -  **Retry upon Timeout**                                                                                                                                                                                                                                 |
   |                                                                |                       |    -  **Maximum Retries**                                                                                                                                                                                                                                    |
   |                                                                |                       |    -  **Retry Interval (seconds)**                                                                                                                                                                                                                           |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       | -  **No**: The node will not be re-executed. This is the default setting.                                                                                                                                                                                    |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       |    .. note::                                                                                                                                                                                                                                                 |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       |       If retry is configured for a job node and the timeout duration is configured, the system allows you to retry a node when the node execution times out.                                                                                                 |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       |       If a node is not re-executed when it fails upon timeout, you can go to the **Default Configuration** page to modify this policy.                                                                                                                       |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       |       **Retry upon Timeout** is displayed only when **Retry upon Failure** is set to **Yes**.                                                                                                                                                                |
   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Policy for Handling Subsequent Nodes If the Current Node Fails | Yes                   | Operation that will be performed if the node fails to be executed. Possible values:                                                                                                                                                                          |
   |                                                                |                       |                                                                                                                                                                                                                                                              |
   |                                                                |                       | -  **Suspend execution plans of the subsequent nodes**: stops running subsequent nodes. The job instance status is **Failed**.                                                                                                                               |
   |                                                                |                       | -  **End the current job execution plan**: stops running the current job. The job instance status is **Failed**.                                                                                                                                             |
   |                                                                |                       | -  **Go to the next node**: ignores the execution failure of the current node. The job instance status is **Failure ignored**.                                                                                                                               |
   |                                                                |                       | -  **Suspend the current job execution plan**: If the current job instance is in abnormal state, the subsequent nodes of this node and the subsequent job instances that depend on the current job are in waiting state.                                     |
   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Enable Dry Run                                                 | No                    | If you select this option, the node will not be executed, and a success message will be returned.                                                                                                                                                            |
   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Task Groups                                                    | No                    | Select a task group. If you select a task group, you can control the maximum number of concurrent nodes in the task group in a fine-grained manner in scenarios where a job contains multiple nodes, a data patching task is ongoing, or a job is rerunning. |
   +----------------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _dataartsstudio_01_0456__en-us_topic_0114569494_table987664914213:

.. table:: **Table 3** Lineage

   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter    | Description                                                                                                                                                 |
   +==============+=============================================================================================================================================================+
   | **Input**    |                                                                                                                                                             |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Add          | Click **Add**. In the **Type** drop-down list, select the type to be created. The value can be **DWS**, **OBS**, **CSS**, **HIVE**, **DLI**, or **CUSTOM**. |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | OK           | Click **OK** to save the parameter settings.                                                                                                                |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Cancel       | Click **Cancel** to cancel the parameter settings.                                                                                                          |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Modify       | Click |image8| to modify the parameter settings. After the modification, save the settings.                                                                 |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete       | Click |image9| to delete the parameter settings.                                                                                                            |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | View Details | Click |image10| to view details about the table created based on the input lineage.                                                                         |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | **Output**   |                                                                                                                                                             |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Add          | Click **Add**. In the **Type** drop-down list, select the type to be created. The value can be **DWS**, **OBS**, **CSS**, **HIVE**, **DLI**, or **CUSTOM**. |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | OK           | Click **OK** to save the parameter settings.                                                                                                                |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Cancel       | Click **Cancel** to cancel the parameter settings.                                                                                                          |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Modify       | Click |image11| to modify the parameter settings. After the modification, save the settings.                                                                |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Delete       | Click |image12| to delete the parameter settings.                                                                                                           |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | View Details | Click |image13| to view details about the table created based on the output lineage.                                                                        |
   +--------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. |image1| image:: /_static/images/en-us_image_0000002234245684.png
.. |image2| image:: /_static/images/en-us_image_0000002269198773.png
.. |image3| image:: /_static/images/en-us_image_0000002269198765.png
.. |image4| image:: /_static/images/en-us_image_0000002234079480.png
.. |image5| image:: /_static/images/en-us_image_0000002269118737.png
.. |image6| image:: /_static/images/en-us_image_0000002269198821.png
.. |image7| image:: /_static/images/en-us_image_0000002269118733.png
.. |image8| image:: /_static/images/en-us_image_0000002269198773.png
.. |image9| image:: /_static/images/en-us_image_0000002269198765.png
.. |image10| image:: /_static/images/en-us_image_0000002234079480.png
.. |image11| image:: /_static/images/en-us_image_0000002269118737.png
.. |image12| image:: /_static/images/en-us_image_0000002269198821.png
.. |image13| image:: /_static/images/en-us_image_0000002269118733.png
