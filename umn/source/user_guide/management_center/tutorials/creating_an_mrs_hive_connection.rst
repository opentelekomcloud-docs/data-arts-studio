:original_name: dataartsstudio_01_0351.html

.. _dataartsstudio_01_0351:

Creating an MRS Hive Connection
===============================

This section describes how to create an MRS Hive connection between DataArts Studio and the data lake base.

Prerequisites
-------------

-  You have created a data lake to connect, for example, a database or cloud service supported by DataArts Studio.

   -  Before creating a DWS data connection, ensure that you have created a cluster in DWS and have the permissions required to view Key Management Service (KMS) keys.
   -  Before creating an MRS HBase, MRS Hive, MRS Kafka, MRS Presto, or MRS Spark connection, ensure that you have created an MRS cluster and selected required components.
   -  Before creating an RDS data connection, ensure that you have an RDS database instance. Currently, DataArts Studio supports only MySQL and PostgreSQL databases in RDS.

-  The data lake to connect communicates with the DataArts Studio instance properly.

   -  If the data lake is an on-premises database, a public network or a dedicated connection is required. Ensure that the host where the data source is located can access the public network and the port has been enabled in the firewall rule.
   -  If the data lake is a cloud service (such as DWS and MRS), the following requirements must be met for network interconnection:

      -  If the CDM cluster in the DataArts Studio instance and the cloud service are in different regions, a public network or a dedicated connection is required.
      -  If the CDM cluster in the DataArts Studio instance and the cloud service are in the same region, VPC, subnet, and security group, they can communicate with each other by default. If they are in the same VPC but in different subnets or security groups, you must configure routing rules and security group rules. For details about how to configure routing rules, see **Adding Routes** in *Virtual Private Cloud (VPC) Usage Guide*. For details about how to configure security group rules, see **Security Group** > **Adding a Security Group Rule** in *Virtual Private Cloud (VPC) Usage Guide*.
      -  The cloud service instance and the DataArts Studio workspace belong to the same enterprise project. If they do not, you can modify the enterprise project of the workspace.

Creating a Data Connection
--------------------------

#. On the DataArts Studio console, locate a workspace and click **Management Center**.


   .. figure:: /_static/images/en-us_image_0000001373087833.png
      :alt: **Figure 1** Management Center

      **Figure 1** Management Center

2. In the navigation pane, choose **Manage Data Connections**.


   .. figure:: /_static/images/en-us_image_0000001373168637.png
      :alt: **Figure 2** Manage Data Connections

      **Figure 2** Manage Data Connections

3. On the **Manage Data Connections** page, click **Create Data Connection**. In the displayed dialog box, select **MRS Hive** for **Data Connection Type** and set other parameters based on the descriptions in :ref:`Table 1 <dataartsstudio_01_0351__table11826143220444>`.


   .. figure:: /_static/images/en-us_image_0000001322248328.png
      :alt: **Figure 3** Create Data Connection

      **Figure 3** Create Data Connection


   .. figure:: /_static/images/en-us_image_0000001321928716.png
      :alt: **Figure 4** MRS Hive connection parameters

      **Figure 4** MRS Hive connection parameters

   .. _dataartsstudio_01_0351__table11826143220444:

   .. table:: **Table 1** MRS Hive data connection

      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter             | Mandatory             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      +=======================+=======================+====================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
      | Data Connection Name  | Yes                   | The name of the data connection to create. Data connection names can contain 1 to 50 characters. They can include only letters, numbers, underscores (_), and hyphens (-).                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Tag                   | No                    | The attribute of the data connection to create. Tags make management easier.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       |    The name of the tag. Only letters, numbers, and underscores (_) are allowed. Tag names cannot start with underscores (_). Enter up to 100 characters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Cluster Name          | Yes                   | The name of the MRS Hive cluster. Select an MRS cluster that Hive belongs to. If the MRS cluster is not displayed in the drop-down list, check whether the network connection between the MRS cluster and the DataArts Studio instance is normal.                                                                                                                                                                                                                                                                                                                                                                                                  |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | Ensure that the MRS cluster and the DataArts Studio instance can communicate with each other. The following requirements must be met for network interconnection:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | -  If the CDM cluster in the DataArts Studio instance and the MRS cluster are in different regions, a public network or a dedicated connection is required. If the Internet is used for communication, ensure that an EIP has been bound to the CDM cluster, and the MRS cluster can access the Internet and the port has been enabled in the firewall rule.                                                                                                                                                                                                                                                                                       |
      |                       |                       | -  If the CDM cluster in the DataArts Studio instance and the MRS cluster are in the same region, VPC, subnet, and security group, they can communicate with each other by default. If they are in the same VPC but in different subnets or security groups, you must configure routing rules and security group rules. For details about how to configure routing rules, see **Custom Route in Region Type I** > **Adding Routes** in *Virtual Private Cloud (VPC) Usage Guide*. For details about how to configure security group rules, see **Security Group** > **Adding a Security Group Rule** in *Virtual Private Cloud (VPC) Usage Guide*. |
      |                       |                       | -  The MRS cluster and the DataArts Studio workspace belong to the same enterprise project. If they do not, you can modify the enterprise project of the workspace.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Connection Type       | Yes                   | Connection type. **Proxy connection** is recommended.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | -  **Proxy connection**: An agent (CDM cluster) is used to access MRS clusters. This method supports all versions of MRS clusters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | -  MRS API connection: MRS APIs are used to access MRS clusters. This method supports only MRS clusters of the 2.\ *X* or a later version.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       |    When you select **MRS API connection**, pay attention to the following restrictions:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       |    a. Tables and fields cannot be viewed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      |                       |                       |    b. When the SQL editor is used to run SQL statements, the execution results can be displayed only in logs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      |                       |                       |    c. This method is not supported by data governance functions such as DataArts Architecture, DataArts Quality, and DataArts Catalog.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Username              | No                    | The username of the MRS cluster. This parameter is mandatory when **Connection Type** is set to **Proxy connection**. If a new MRS user is used for connection, you need to log in to Manager and change the initial password.                                                                                                                                                                                                                                                                                                                                                                                                                     |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | You cannot create a data connection for an MRS security cluster as user **admin**. User **admin** is the management page user by default and cannot be used as the authentication user of a security cluster. When creating an MRS data connection, set **Username** and **Password** to the new MRS username and password.                                                                                                                                                                                                                                                                                                                        |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       |    -  For clusters of MRS 3.1.0 or later, the user must at least have permissions of the **Manager_viewer** role to create data connections in Management Center. To perform database, table, and data operations on components, the user must also have user group permissions of the components.                                                                                                                                                                                                                                                                                                                                                 |
      |                       |                       |    -  For clusters earlier than MRS 3.1.0, the user must have permissions of the **Manager_administrator** or **System_administrator** role to create data connections in Management Center.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
      |                       |                       |    -  A user with only the **Manager_tenant** or **Manager_auditor** permission cannot create connections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Password              | No                    | The password for accessing the MRS cluster. This parameter is mandatory when **Connection Type** is set to **Proxy connection**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | KMS Key               | No                    | The name of the KMS key. This parameter is mandatory when **Connection Type** is set to **Proxy connection**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Agent                 | No                    | This parameter is mandatory when **Connection Type** is set to **Proxy connection**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | MRS is not a fully managed service and cannot be directly connected to DataArts Studio. A CDM cluster can provide an agent for DataArts Studio to communicate with non-fully-managed services. Therefore, you need to select a CDM cluster when creating an MRS data connection. If no CDM cluster is available, create one through the DataArts Migration incremental package.                                                                                                                                                                                                                                                                    |
      |                       |                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                       |                       | As a network proxy, the CDM cluster must be able to communicate with the MRS cluster. To ensure network connectivity, the CDM cluster must be in the same region, AZ, VPC, and subnet as the MRS cluster. The security group rule must also allow the CDM cluster communicate with the MRS cluster.                                                                                                                                                                                                                                                                                                                                                |
      +-----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

4. Click **Test** to test connectivity of the data connection. If the test fails, the data connection fails to be created.

5. After the test is successful, click **OK** to create the data connection.

Reference
---------

#. Why is no MRS Hive cluster available in the dialog box for creating a data connection?

   Possible causes are as follows:

   -  Hive/HBase components were not selected during MRS cluster creation.

   -  The network between the CDM cluster and MRS cluster was disconnected when an MRS data connection is created.

      The CDM cluster functions as a network agent. MRS data connections that you are going to create need to communicate with CDM.

#. Why does a Hive data connection fail to obtain information about databases or tables?

   The possible cause is that the CDM cluster is stopped or a concurrency conflict occurs. You can switch to another agent to temporarily avoid this issue.
